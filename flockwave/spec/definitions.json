{
    "attitude": {
        "$schema": "http://json-schema.org/schema#",
        "$id": "http://collmot.com/schemas/flockwave/1.0/attitude.json",

        "title": "Attitude",
        "description": "Attitude around the principal aircraft axes",
        "type": "object",
        "properties": {
            "roll": {
                "type": "number",
                "minimum": -90,
                "exclusiveMaximum": 90
            },
            "pitch": {
                "type": "number",
                "minimum": -90,
                "exclusiveMaximum": 90
            },
            "yaw": {
                "type": "number",
                "minimum": 0,
                "exclusiveMaximum": 360
            }
        },
        "required": [ "roll", "pitch", "yaw" ],
        "additionalProperties": false
    },

    "batteryInfo": {
        "$schema": "http://json-schema.org/schema#",
        "$id": "http://collmot.com/schemas/flockwave/1.0/attitude.json",

        "title": "Battery information",
        "description": "Information about the on-board battery of the UAV, if applicable",
        "type": "object",
        "properties": {
            "percentage": {
                "title": "State of charge (%)",
                "description": "Percentage indicator of the state of charge of the battery (100% = full, 0% = empty)",
                "type": "number",
                "minimum": 0,
                "maximum": 100
            },
            "voltage": {
                "title": "Battery voltage",
                "description": "The voltage of the battery",
                "type": "number"
            }
        },
        "additionalProperties": false
    },

    "channelId": {
        "title": "Channel ID",
        "description": "Identifier of a single channel of a single device on a UAV",
        "type": "string",
        "minLength": 1,
        "maxLength": 64,
        "pattern": "^[^/]+$"
    },

    "channelOperation": {
        "title": "Operation",
        "description": "Operation that can be performed on a channel",
        "type": "string",
        "enum": [
            "read", "write"
        ]
    },

    "channelType": {
        "title": "Type",
        "description": "Type of a channel",
        "type": "string",
        "enum": [
            "audio", "boolean", "bytes", "color", "duration", "object",
            "number", "string", "time", "video"
        ]
    },

    "clockEpoch": {
        "anyOf": [
            {
                "type": "string",
                "format": "date-time"
            },
            {
                "type": "string",
                "enum": [ "unix" ]
            }
        ]
    },

    "clockId": {
        "title": "Clock ID",
        "description": "Identifier of a single clock",
        "type": "string",
        "minLength": 1,
        "maxLength": 64
    },

    "clockIdList": {
        "title": "Clock IDs",
        "description": "IDs of the clocks that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/clockId"
        },
        "uniqueItems": true
    },

    "clockInfo": {
        "title": "Clock info",
        "description": "Information about a clock",
        "type": "object",
        "properties": {
            "id": {
                "$ref": "definitions.json#/clockId"
            },
            "epoch": {
                "$ref": "definitions.json#/clockEpoch"
            },
            "retrievedAt": {
                "type": "string",
                "format": "datetime"
            },
            "running": {
                "type": "boolean"
            },
            "ticksPerSecond": {
                "type": "number",
                "minimum": 0,
                "exclusiveMinimum": true
            },
            "timestamp": {
                "type": "number"
            }
        },
        "required": [ "id", "retrievedAt", "running", "timestamp" ]
    },

    "commandExecutionStatus": {
        "title": "Command execution status",
        "description": "Execution status of a command executed on a UAV",
        "type": "object",
        "properties": {
            "id": {
                "$ref": "definitions.json#/receiptId"
            },
            "sent": {
                "type": "string",
                "format": "date-time"
            },
            "acknowledged": {
                "type": "string",
                "format": "date-time"
            },
            "updated": {
                "type": "string",
                "format": "date-time"
            },
            "finished": {
                "type": "string",
                "format": "date-time"
            },
            "progress": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
            }
        },
        "required": [ "sent" ],
        "additionalProperties": false
    },

    "commandResponse": {
        "title": "Command response",
        "description": "Response given by a UAV to a command request",
        "type": "object",
        "properties": {
            "type": {
                "type": "string"
            },
            "data": {},
            "additionalProperties": false,
            "required": [ "type", "data" ]
        }
    },

    "connectionId": {
        "title": "Connection ID",
        "description": "Identifier of a single connection",
        "type": "string",
        "minLength": 1,
        "maxLength": 64
    },

    "connectionIdList": {
        "title": "Connection IDs",
        "description": "IDs of the connections that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/connectionId"
        },
        "uniqueItems": true
    },

    "connectionInfo": {
        "title": "Connection info",
        "description": "Information about a connection",
        "type": "object",
        "properties": {
            "id": {
                "$ref": "definitions.json#/connectionId"
            },
            "purpose": {
                "$ref": "definitions.json#/connectionPurpose"
            },
            "description": {
                "type": "string"
            },
            "status": {
                "$ref": "definitions.json#/connectionStatus"
            },
            "timestamp": {
                "type": "string",
                "format": "date-time"
            }
        },
        "required": [ "id", "purpose", "status" ]
    },

    "connectionPurpose": {
        "title": "Purpose",
        "description": "Purpose of the connection",
        "type": "string",
        "enum": ["debug", "dock", "dgps", "gps", "time", "uavRadioLink", "other"]
    },

    "connectionStatus": {
        "title": "Status",
        "description": "Status of the connection",
        "type": "string",
        "enum": [
            "disconnected", "connecting", "connected", "disconnecting",
            "unknown"
        ]
    },

    "deviceClass": {
        "title": "Class",
        "description": "Class of a device",
        "type": "string",
        "enum": [
            "accelerometer", "actuator", "altimeter", "battery", "camera",
            "cpu", "cpuCore", "gps", "group", "gyroscope", "led",
            "magnetometer", "microphone", "misc", "pyro", "radio", "rc",
            "rotor", "sensor", "speaker"
        ],
        "default": "misc"
    },

    "deviceId": {
        "title": "Device ID",
        "description": "Identifier of a single device on a UAV",
        "type": "string",
        "minLength": 1,
        "maxLength": 64,
        "pattern": "^[^/]+$"
    },

    "deviceTreeNode": {
        "title": "Device tree node",
        "description": "A single device tree node representing a UAV, a device or a channel",
        "type": "object",
        "properties": {
            "type": {
                "$ref": "#/deviceTreeNodeType"
            },
            "subType": {
                "$ref": "#/channelType"
            },
            "class": {
                "$ref": "#/deviceClass"
            },
            "children": {
                "type": "object",
                "additionalProperties": {
                    "$ref": "#/deviceTreeNode"
                }
            },
            "operations": {
                "type": "array",
                "items": {
                    "$ref": "#/channelOperation"
                }
            },
            "unit": {
                "title": "Unit",
                "description": "Unit in which the value of a numeric channel is expressed",
                "type": "string"
            }
        },
        "required": [ "type" ],
        "additionalProperties": false
    },

    "deviceTreeNodeType": {
        "title": "Type",
        "description": "Type of a device tree node",
        "type": "string",
        "enum": [
            "root", "uav", "device", "channel"
        ]
    },

    "deviceTreePath": {
        "title": "Device tree path",
        "description": "An absolute device path that uniquely identifies a UAV, a device on a UAV or a channel of a device on a UAV",
        "type": "string",
        "minLength": 1,
        "pattern": "^((/[^/]+)+|/)$"
    },

    "deviceTreePathList": {
        "title": "Device tree paths",
        "description": "Paths of the device tree entries that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/deviceTreePath"
        }
    },

    "errorList": {
        "title": "List of errors",
        "description": "List of currently active error codes for a single UAV",
        "type": "array",
        "items": {
            "type": "number"
        }
    },

    "failureReasons": {
        "type": "object",
        "additionalProperties": {
            "type": "string"
        }
    },

    "gpsCoordinate": {
        "$schema": "http://json-schema.org/schema#",
        "$id": "http://collmot.com/schemas/flockwave/1.0/gps_coordinate.json",

        "title": "GPS coordinate",
        "description": "GPS coordinate of a UAV",
        "type": "object",
        "properties": {
            "lat": {
                "title": "Latitude",
                "description": "Latitude, in degrees",
                "type": "number",
                "minimum": -90,
                "maximum": 90
            },
            "lon": {
                "title": "Longitude",
                "description": "Longitude, in degrees",
                "type": "number",
                "minimum": -180,
                "maximum": 180
            },
            "amsl": {
                "title": "AMSL",
                "description": "Altitude above mean sea level, in meters",
                "type": "number"
            },
            "agl": {
                "title": "AGL",
                "description": "Altitude above ground level, in meters",
                "type": "number"
            }
        },
        "required": [ "lat", "lon" ],
        "additionalProperties": false
    },

    "messageId": {
        "title": "Message ID",
        "description": "Identifier of the message",
        "type": "string",
        "minLength": 1,
        "maxLength": 36
    },

    "objectIdList": {
        "title": "Object IDs",
        "description": "IDs of the objects that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/objectId"
        },
        "uniqueItems": true
    },

    "objectId": {
        "title": "Object ID",
        "description": "Identifier of a single object",
        "type": "string",
        "minLength": 1,
        "maxLength": 64,
        "pattern": "^[^/]+$"
    },

    "objectType": {
        "title": "Object type",
        "description": "Type of an object tracked by the server",
        "type": "string",
        "examples": [
            "beacon", "dock", "other", "uav", "weatherStation"
        ]
    },

    "objectTypeFilter": {
        "title": "Object types",
        "description": "Types of objects that the user is interested in",
        "type": "array",
        "items": {
            "$ref": "#/objectType"
        },
        "uniqueItems": true
    },

    "receiptId": {
        "title": "Receipt ID",
        "description": "Identifier of the receipt",
        "type": "string",
        "minLength": 1,
        "maxLength": 64
    },

    "receiptIdList": {
        "title": "Receipt IDs",
        "description": "IDs of the receipts that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/receiptId"
        },
        "uniqueItems": true
    },

    "uavIdList": {
        "title": "UAV IDs",
        "description": "IDs of the UAVs that the message refers to",
        "type": "array",
        "items": {
            "$ref": "#/objectId"
        },
        "uniqueItems": true
    },

    "uavStatusInfo": {
        "$schema": "http://json-schema.org/schema#",
        "$id": "http://collmot.com/schemas/flockwave/1.0/uav_status_info.json",

        "title": "UAV status info",
        "description": "Status information of a single UAV",
        "type": "object",
        "properties": {
            "id": {
                "$ref": "definitions.json#/objectId"
            },
            "algorithm": {
                "title": "Algorithm",
                "description": "The algorithm that the UAV is running (if applicable)",
                "type": "string"
            },
            "position": {
                "$ref": "definitions.json#/gpsCoordinate"
            },
            "heading": {
                "title": "Heading",
                "description": "The heading of the UAV in the local tangent plane",
                "type": "number",
                "minimum": 0,
                "exclusiveMaximum": 360
            },
            "attitude": {
                "$ref": "definitions.json#/attitude"
            },
            "velocity": {
                "$ref": "definitions.json#/velocityNED"
            },
            "timestamp": {
                "title": "Last updated at",
                "description": "Timestamp that denotes when the status of the UAV was updated the last time",
                "type": "string",
                "format": "date-time"
            },
            "battery": {
                "$ref": "definitions.json#/batteryInfo"
            },
            "error": {
                "$ref": "definitions.json#/errorList"
            }
        },
        "required": ["id", "position", "timestamp"]
    },

    "velocityNED": {
        "$schema": "http://json-schema.org/schema#",
        "$id": "http://collmot.com/schemas/flockwave/1.0/velocity_ned.json",

        "title": "Velocity (NED)",
        "description": "Velocity in the NED coordinate system",
        "type": "object",
        "properties": {
            "north": {
                "type": "number"
            },
            "east": {
                "type": "number"
            },
            "down": {
                "type": "number"
            }
        },
        "required": [ "north", "east", "down" ],
        "additionalProperties": false
    },

    "versionNumber": {
        "title": "Version",
        "description": "Version number in major.minor.patch format; minor and patch versions are optional",
        "type": "string",
        "pattern": "^[0-9]+(\\.[0-9]+){0,2}$"
    },

    "userName": {
        "title": "Username",
        "description": "Name of the user",
        "type": "string",
        "pattern": "^[-A-Za-z0-9!#$%&'*+/=?\\^_`{|}~]*(@[-A-Za-z0-9!#$%&'*+/=?\\^_`{|}~.]+)?$"
    }
}
